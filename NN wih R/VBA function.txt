
Function hec_calculator()




End Function


Function fminmax(x1, xmin, xmax)

fminmax = WorksheetFunction.Min(WorksheetFunction.max(x1, xmin), xmax)

End Function

Function nn_sep_new_case2(xx1, xx2, xx3, hidden2_)
    
    x1 = fminmax(xx1, 0.01, 0.92)
    x2 = fminmax(xx2, 0.47, 1.5)
    x3 = fminmax(xx4, 0.17, 0.47)
    
    If hidden2_ = 0 Then

'rmse1= 0.1994184531
z = 0.648670075898809 + 0.126004883768758 * x2 + 0.276076275095449 * x3 + -0.651257169293666 * x4


    ElseIf hidden2_ = 1 Then

'rmse1= 0.1986960891
z = 0.608871209244072
z = z + 0.176818363223933 * 1 / (1 + Exp(-(-2.79812153057428 + 4.33049621602018 * x1 + 12.9165365978677 * x2 + -26.4305294153611 * x3)))

        
    ElseIf hidden2_ = 2 Then

'rmse1= 0.123957892
z = -1.50164931495976
z = z + 2.11766338745658 * 1 / (1 + Exp(-(-2.4732587251981 + 7.52779317929807 * x1 + -3.27770057276425 * x2 + 6.79082229199627E-02 * x3)))
z = z + 2.16214131983083 * 1 / (1 + Exp(-(2.68678798138304 + -7.31443783073277 * x1 + 25.731540142274 * x2 + -50.1308000743711 * x3)))

       
    ElseIf hidden2_ = 3 Then

'rmse1= 0.1026692811
z = -0.804732428367969
z = z + 2.76905246616423 * 1 / (1 + Exp(-(-0.987702607762754 + 5.87203582934595 * x1 + -2.24447920686347 * x2 + -3.93686653508326 * x3)))
z = z + -1.24851149274643 * 1 / (1 + Exp(-(3.61763153582511 + 10.1009785604996 * x1 + -1.216351815248 * x2 + -8.49639880958318 * x3)))
z = z + 2.4031488791813 * 1 / (1 + Exp(-(0.478716793715238 + -6.94727412945332 * x1 + 24.9958682264225 * x2 + -39.570504543539 * x3)))

            
    ElseIf hidden2_ = 4 Then

'rmse1= 0.07836242592
z = 1.61515363679087
z = z + 9.92647886206838 * 1 / (1 + Exp(-(0.342502789709684 + 3.72424413069415 * x1 + -0.807358792283508 * x2 + -11.4869764327337 * x3)))
z = z + -8.08242792932074 * 1 / (1 + Exp(-(-0.328048905846451 + 4.89743804002487 * x1 + -7.77077472197888 * x2 + 3.91656651351098 * x3)))
z = z + -0.911046705104065 * 1 / (1 + Exp(-(-0.726756115685001 + 29.921284777139 * x1 + -9.28756033350962 * x2 + 17.3867311354698 * x3)))
z = z + -5.36509159253614 * 1 / (1 + Exp(-(0.855549951193826 + -0.448946929499338 * x1 + 2.63503002875206 * x2 + -17.6264105903304 * x3)))

    ElseIf hidden2_ = 5 Then
      
'rmse1= 0.06928583897
            
    End If
    
    z = fminmax(z, 0.44, 1.3)
    
    nn_sep_new_case2 = z

End Function

Function nn_sep_new_case3(xx1, xx2, xx3, xx4, hidden3_)

    x1 = fminmax(xx1, 0, 1.83)
    x2 = fminmax(xx2, 0, 0.88)
    x3 = fminmax(xx3, 0.05, 0.7)
    x4 = fminmax(xx4, 0.02, 0.47)
    
    If hidden3_ = 0 Then

'rmse1= 0.1998873161
z = 0.747960306524706 + 1.06231744999831E-02 * x2 + -3.25962145007698E-02 * x3 + 0.082046314666793 * x4 + -7.36434618281029E-02 * x5

    ElseIf hidden3_ = 1 Then

'rmse1= 0.1695525401
z = 1.1776730673911
z = z + -0.460199365465214 * 1 / (1 + Exp(-(-20.6935354867165 + 33.3051180323252 * x1 + 9.02204426673642 * x2 + 3.47428324083689 * x3 + 42.6743732026903 * x4)))
       
    ElseIf hidden3_ = 2 Then

'rmse1= 0.1452562778
z = 2.10501773045012
z = z + -2.76404545569385 * 1 / (1 + Exp(-(-2.78881562545011E-02 + -2.60554341125568 * x1 + 7.66657760647926E-02 * x2 + 0.95206791269791 * x3 + -6.46851099796192 * x4)))
z = z + -1.28825900403537 * 1 / (1 + Exp(-(-10.6245171864908 + 14.2233037028805 * x1 + 1.03097243568636 * x2 + -16.4199347382399 * x3 + 69.1864628323113 * x4)))

    ElseIf hidden3_ = 3 Then

'rmse1= 0.1301584308
z = 0.155801782063083
z = z + 0.97942502198231 * 1 / (1 + Exp(-(4.99971360613156 + -7.82539763660358 * x1 + -0.431845589649475 * x2 + 8.75447949695645 * x3 + -26.6186952549045 * x4)))
z = z + 1.43075914339999 * 1 / (1 + Exp(-(-6.39600803816385 + 0.479647085199833 * x1 + 0.461954877983112 * x2 + 1.48849991350736 * x3 + 10.4665861027396 * x4)))
z = z + 0.498933755700507 * 1 / (1 + Exp(-(-0.44637854874173 + 29.0519326247901 * x1 + -2.60321845222982 * x2 + -43.0245708743362 * x3 + -20.9670563711459 * x4)))

    ElseIf hidden3_ = 4 Then

'rmse1= 0.1053446125
z = -1.25218787633602
z = z + 3.20663232076008 * 1 / (1 + Exp(-(-1.68585365580147 + 4.89800875292781 * x1 + -0.408259829211212 * x2 + 0.159427524435765 * x3 + 6.14524053744312 * x4)))
z = z + -1.09544860068246 * 1 / (1 + Exp(-(-9.69925910520066 + 1.22214970754102E-02 * x1 + -4.4302122246822 * x2 + 97.5778274266778 * x3 + -8.01893252749021 * x4)))
z = z + 1.59707430762813 * 1 / (1 + Exp(-(10.9169534208843 + -19.6995478682068 * x1 + -0.339766608201649 * x2 + 4.75505236026731 * x3 + -30.9560891885639 * x4)))
z = z + -1.10439877403473 * 1 / (1 + Exp(-(-20.4793348057266 + 8.15092011162576 * x1 + 11.200754505052 * x2 + -160.611011119293 * x3 + 164.059445518454 * x4)))
    
    ElseIf hidden3_ = 5 Then

'rmse1= 0.09799310004

    End If
    z = fminmax(z, 0.35, 1.46)
    nn_sep_new_case3 = z

End Function

Function nn_sep_new_case4(xx1, xx2, xx3, xx4, hidden4_)

    x1 = fminmax(xx1, 0, 1.83)
    x2 = fminmax(xx2, 0, 2.7)
    x3 = fminmax(xx3, 0.05, 2.14)
    x4 = fminmax(xx4, 0.1, 1.59)
    
    
    If hidden4_ = 0 Then

'rmse1= 0.3136668019
z = 0.881597753776908 + -0.205446300709443 * x2 + 0.31495750674028 * x3 + 0.391661652676047 * x4 + -0.714297193935583 * x5

    
    ElseIf hidden4_ = 1 Then

'rmse1= 0.2759630445
z = 0.698882011240852
z = z + 0.98451331274693 * 1 / (1 + Exp(-(21.9675889113971 + -31.3303434047964 * x1 + -1.86244512626222 * x2 + -27.3401130300118 * x3 + -6.25432748907488 * x4)))

    ElseIf hidden4_ = 2 Then

'rmse1= 0.2314717095
z = 0.425623347211017
z = z + 0.379331195586868 * 1 / (1 + Exp(-(-23.3688134976716 + 7.55491152632226 * x1 + 30.1477738177802 * x2 + 38.8104433532655 * x3 + -4.27746573610916 * x4)))
z = z + 0.966906311350696 * 1 / (1 + Exp(-(29.1499838601109 + -39.2577617747698 * x1 + -4.45758963817992 * x2 + -37.8483240254919 * x3 + -4.72115903433676 * x4)))

    ElseIf hidden4_ = 3 Then

'rmse1= 0.2027297337
z = 2.14409635331259
z = z + -0.377667193242155 * 1 / (1 + Exp(-(34.9076846889397 + -10.6647083683204 * x1 + -43.3270335092757 * x2 + -59.1968919478301 * x3 + 6.51547226037593 * x4)))
z = z + -1.2875448158641 * 1 / (1 + Exp(-(-9.99802200783412 + 19.3702246180365 * x1 + 0.904731350737021 * x2 + 13.6466780415529 * x3 + -5.95053611335967 * x4)))
z = z + -15.631354774493 * 1 / (1 + Exp(-(-3.83520960840652 + -3.18878269904855 * x1 + 0.294040589304165 * x2 + 0.582192209288603 * x3 + 0.445967139410891 * x4)))

    ElseIf hidden4_ = 4 Then

'rmse1= 0.1846157188
z = 0.693659370804058
z = z + -1.25643769389185 * 1 / (1 + Exp(-(-0.151225160785608 + 2.23216944060469 * x1 + -1.82908745556141 * x2 + -6.80674078272873 * x3 + 3.35887759995816 * x4)))
z = z + 1.08102333147941 * 1 / (1 + Exp(-(-10.6575836556814 + 12.7813843332452 * x1 + 2.80958139725198 * x2 + -4.48030441692378 * x3 + 2.86878366152693 * x4)))
z = z + -11.2683048001942 * 1 / (1 + Exp(-(0.110873977437045 + -1.38239696232656 * x1 + 0.126273823038916 * x2 + -1.04808851626054 * x3 + -12.2520374048578 * x4)))
z = z + 4.61881724012803 * 1 / (1 + Exp(-(2.95471607557178 + -4.80097007124038 * x1 + -0.442755363409856 * x2 + -4.51881797715461 * x3 + -3.54539661034526 * x4)))


    ElseIf hidden4_ = 5 Then

'rmse1= 0.1450950796

    End If
    
    z = fminmax(z, 0.01, 1.88)
    
    nn_sep_new_case4 = z

End Function



Function nn_sep_new_case5(xx1, xx2, xx3, hidden5_)
    
    x1 = fminmax(xx1, 0, 1.83)
    x2 = fminmax(xx2, -2.14, -0.07)
    x3 = fminmax(xx3, 0.05, 1.15)
    
    
    If hidden5_ = 0 Then

'rmse1= 0.2226225961
z = 0.696002717117574 + -0.154728765194266 * x2 + -0.169797975733721 * x3 + -4.30607011951158E-02 * x4

    ElseIf hidden5_ = 1 Then

'rmse1= 0.2141789761
z = 0.580606686909534
z = z + 0.286529175413541 * 1 / (1 + Exp(-(-1.79863451393582 + -18.9538402858531 * x1 + -15.7206464138794 * x2 + 0.421015633391207 * x3)))

    ElseIf hidden5_ = 2 Then

'rmse1= 0.1828161323
z = -8.87726707087428E-02
z = z + 1.72952829239844 * 1 / (1 + Exp(-(0.941557707139915 + -0.148859714487693 * x1 + -1.32142433838537 * x2 + -2.10967120221226 * x3)))
z = z + -0.663623845530488 * 1 / (1 + Exp(-(3.81928042312724 + 3.02540603947389 * x1 + -7.46840483474001 * x2 + -22.1577451697951 * x3)))

    ElseIf hidden5_ = 3 Then

'rmse1= 0.1574244593
z = -1.53954691293072
z = z + 0.35545701253074 * 1 / (1 + Exp(-(8.28008879485187 + -24.7594669662458 * x1 + -0.79441722333248 * x2 + -4.82963268844933 * x3)))
z = z + 2.3853753239287 * 1 / (1 + Exp(-(-1.74592516239589 + 7.07441033867264E-03 * x1 + -3.42564040772347 * x2 + 1.63633799908309 * x3)))
z = z + 1.24775782950634 * 1 / (1 + Exp(-(10.1990474126503 + -4.85503707315574E-02 * x1 + 14.8266113852526 * x2 + -7.94965827450197 * x3)))


    ElseIf hidden5_ = 4 Then

'rmse1= 0.1287314848
z = 0.151864695565989
z = z + -0.3250865754515 * 1 / (1 + Exp(-(-4.50438454017245 + 7.81489471341921 * x1 + 54.6196886843763 * x2 + 107.131510242938 * x3)))
z = z + 1.78737748430511 * 1 / (1 + Exp(-(-5.45407215752789 + 12.8882644015835 * x1 + 0.443389729550816 * x2 + -16.2666278047078 * x3)))
z = z + 1.32951229104048 * 1 / (1 + Exp(-(-3.50374104787841 + -11.0401925800106 * x1 + -1.95482157818979 * x2 + 48.635538435589 * x3)))
z = z + -1.27839717114947 * 1 / (1 + Exp(-(-2.44870478588424 + 4.96002486512496 * x1 + -7.20229121257776E-02 * x2 + 0.801963888640966 * x3)))

      
    ElseIf hidden5_ = 5 Then

'rmse1= 0.1279534961


    End If
    
    z = fminmax(z, 0.16, 1.18)
    nn_sep_new_case5 = z

End Function



Function rmse_(xrange_ As Range, yrange_ As Range)
    nsize = xrange_.Rows.Count
    temp1 = 0
    For i = 1 To nsize
    temp1 = temp1 + (xrange_.Cells(i, 1) - yrange_.Cells(i, 1)) ^ 2
    Next
    rmse_ = Sqr(temp1 / nsize)
End Function



Function nn_sep_neww(xx1, xx2, xx3, xx4, xx5, xx6, xx7, case_, hidden2_, hidden3_, hidden4_, hidden5_)

    'xx1        xx2     xx3             xx4     xx5     xx6     xx7     z
    'f1/bcol    T'/y    h1'/b*  h1'/y   h'0/y   bcol/y  bpc/y   bpg/y   be/b*
    
    If case_ = 2 Then
        '2      T '/y    bpc/y   bpg/y   be/b*
        'Case    x1     x2       x3      z
        x1 = xx2
        x2 = xx6
        x3 = xx7
        z = nn_sep_new_case2(x1, x2, x3, hidden2_)
        
    ElseIf case_ = 3 Then
        '3       f1/bcol    h'0/y   bcol/y     bpg/y   be/b*
        'Case    x1         x2      x3           x4      z
        x1 = xx1
        x2 = xx4
        x3 = xx5
        x4 = xx7
        z = nn_sep_new_case3(x1, x2, x3, x4, hidden3_)
        
    ElseIf case_ = 4 Then
        'case 4         x1      x2      x3      x4      z
        '-          f1/bcol    h1'/b*  bcol/y  T'/y   be/b*

        x1 = xx1
        x2 = xx3
        x3 = xx5
        x4 = xx2
        z = nn_sep_new_case4(x1, x2, x3, x4, hidden4_)
        
    ElseIf case_ = 5 Then
        '5       f1/bcol h1'/b*  bcol/y  be/b*
        'Case    x1     x2      x3      z
        x1 = xx1
        x2 = xx3
        x3 = xx5
        z = nn_sep_new_case5(x1, x2, x3, hidden5_)
    
    ElseIf case_ = 1 Or case_ = 6 Or case_ = 7 Or case_ = 8 Or case_ = 9 Then
        z = 1
    End If
    
    nn_sep_neww = z
    
End Function
