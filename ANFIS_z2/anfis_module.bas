Attribute VB_Name = "anfis_module"
Function anfis_maker1(xx1, xx2, xx3, xx4, xx5, xx6, xx7)

x1 = Log(xx1 + 0.05) / Log(10)
x2 = Log(xx2 + 0.05) / Log(10)
x3 = Log(xx3 + 2.1) / Log(10)
x4 = Log(xx4 + 1.6) / Log(10)
x5 = Log(xx5 + 0.05) / Log(10)
x6 = Log(xx6) / Log(10)
x7 = Log(xx7 + 0.05) / Log(10)

'x1 = xx1
'x2 = xx2
'x3 = xx3
'x4 = xx4
'x5 = xx5
'x6 = xx6
'x7 = xx7



w1_1 = Exp(-0.5 * (x1 - -0.910103598229499) ^ 2 / 0.199686312751131 ^ 2)
w1_2 = Exp(-0.5 * (x1 - -0.250297727203878) ^ 2 / 0.200081486345983 ^ 2)

w2_1 = Exp(-0.5 * (x2 - -1.27031870024074) ^ 2 / 0.484246783600107 ^ 2)
w2_2 = Exp(-0.5 * (x2 - 2.36646496121888E-02) ^ 2 / 0.399382275777243 ^ 2)

w3_1 = Exp(-0.5 * (x3 - 0.29) ^ 2 / 0.8 ^ 2)

w4_1 = Exp(-0.5 * (x4 - -2.47641015224867E-22) ^ 2 / 0.1 ^ 2)
w4_2 = Exp(-0.5 * (x4 - 0.24) ^ 2 / 0.1 ^ 2)
w4_3 = Exp(-0.5 * (x4 - 0.41) ^ 2 / 0.1 ^ 2)

w5_1 = Exp(-0.5 * (x5 - -0.478822372940986) ^ 2 / 0.500589284283576 ^ 2)

w6_1 = Exp(-0.5 * (x6 - -0.132770449421261) ^ 2 / 0.779533765666133 ^ 2)

w7_1 = Exp(-0.5 * (x7 - 0.27) ^ 2 / 0.5 ^ 2)


ww1 = w1_1 * w2_1 * w3_1 * w4_1 * w5_1 * w6_1 * w7_1
ww2 = w1_1 * w2_2 * w3_1 * w4_1 * w5_1 * w6_1 * w7_1
ww3 = w1_1 * w2_1 * w3_1 * w4_2 * w5_1 * w6_1 * w7_1
ww4 = w1_1 * w2_2 * w3_1 * w4_2 * w5_1 * w6_1 * w7_1
ww5 = w1_1 * w2_1 * w3_1 * w4_3 * w5_1 * w6_1 * w7_1
ww6 = w1_1 * w2_2 * w3_1 * w4_3 * w5_1 * w6_1 * w7_1
ww7 = w1_2 * w2_1 * w3_1 * w4_1 * w5_1 * w6_1 * w7_1
ww8 = w1_2 * w2_2 * w3_1 * w4_1 * w5_1 * w6_1 * w7_1
ww9 = w1_2 * w2_1 * w3_1 * w4_2 * w5_1 * w6_1 * w7_1
ww10 = w1_2 * w2_2 * w3_1 * w4_2 * w5_1 * w6_1 * w7_1
ww11 = w1_2 * w2_1 * w3_1 * w4_3 * w5_1 * w6_1 * w7_1
ww12 = w1_2 * w2_2 * w3_1 * w4_3 * w5_1 * w6_1 * w7_1




z1 = 1.75179737837418 + -0.559423266149012 * x1 + -0.755894522418211 * x2 + 0.28831367209443 * x3 + 0.966035355876864 * x4 + 1.59496050022778 * x5 + 2.08146923806786 * x6 + 0.495883355842617 * x7
z2 = -0.350572258293975 + 1.91339325083353 * x1 + -1.0395695591509 * x2 + 1.02398940675033 * x3 + -0.113266226784139 * x4 + -2.11618365682414 * x5 + -0.229736469129153 * x6 + -0.829687769754835 * x7
z3 = -0.666567955297676 + -3.00535091988296 * x1 + 2.57149561660319 * x2 + -1.89540031619118 * x3 + -0.610894344222023 * x4 + 4.4911087346181 * x5 + 8.99596072575996 * x6 + 2.77099226810205 * x7
z4 = -5.29985588861568 + -8.7889036734934 * x1 + -3.18204870960873 * x2 + -1.27434934984049 * x3 + -0.641790762553829 * x4 + 0.812024872672239 * x5 + 2.62554119035352 * x6 + -0.189973085854628 * x7
z5 = -0.824433596583443 + -0.677836820688586 * x1 + 0.299349618951251 * x2 + -0.237906473496544 * x3 + 4.67178205696871E-02 * x4 + -1.15476984563644 * x5 + 3.77893811290967 * x6 + 9.19981268228929E-02 * x7
z6 = -2.56588194882026 + -1.33854989328017 * x1 + -8.61365536222401E-02 * x2 + -0.561327941726483 * x3 + -0.28277387957634 * x4 + -2.29746828628033 * x5 + -1.56267160214277 * x6 + 1.52727291013351 * x7
z7 = 1.37220641919526 + -0.911969787956789 * x1 + 0.143303310478235 * x2 + -1.20767482301891 * x3 + -1.55038435292599 * x4 + 0.109055243022146 * x5 + -0.020137010881722 * x6 + 1.08182019607527 * x7
z8 = 0.740643810809438 + 1.62502790330218 * x1 + 1.62390521368374 * x2 + 0.40465009057968 * x3 + -0.360840517899516 * x4 + 0.333086768186821 * x5 + -0.624965351095508 * x6 + 9.28851596416206E-02 * x7
z9 = 4.07306775739963 + 0.441706992279139 * x1 + 7.99028250730882 * x2 + 0.289788018333523 * x3 + 1.72376505041709 * x4 + -1.75498654642923 * x5 + 2.8472369881871 * x6 + 0.116980731813543 * x7
z10 = -1.66634797945891 + -1.37524407062767 * x1 + -0.723287636118457 * x2 + 2.97373304937223 * x3 + -0.366008385935186 * x4 + 0.725624265844155 * x5 + -1.2977357340381 * x6 + -0.915255662797989 * x7
z11 = -3.70330356724899E-02 + -2.78149968773387 * x1 + -0.311236517448398 * x2 + -1.62767817569129 * x3 + 0.288930571997295 * x4 + 0.424749493838538 * x5 + -0.736229307675946 * x6 + -0.460862289256756 * x7
z12 = -0.976233446436317 + -0.426783241510135 * x1 + 1.80870306787296 * x2 + -1.40073314116338 * x3 + 3.77857059922381 * x4 + -0.24066499689882 * x5 + 0.173608971292589 * x6 + 0.58029119686704 * x7





wwN = ww1 + ww2 + ww3 + ww4 + ww5 + ww6 + ww7 + ww8 + ww9 + ww10 + ww11 + ww12


z = z1 * ww1 + z2 * ww2 + z3 * ww3 + z4 * ww4 + z5 * ww5 + z6 * ww6 + z7 * ww7 + z8 * ww8 + z9 * ww9 + z10 * ww10 + z11 * ww11 + z12 * ww12


z = z / wwN



z = -0.05 + 10 ^ z



anfis_maker1 = z

End Function

